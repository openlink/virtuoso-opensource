/*
 *  
 *  This file is part of the OpenLink Software Virtuoso Open-Source (VOS)
 *  project.
 *  
 *  Copyright (C) 1998-2006 OpenLink Software
 *  
 *  This project is free software; you can redistribute it and/or modify it
 *  under the terms of the GNU General Public License as published by the
 *  Free Software Foundation; only version 2 of the License, dated June 1991.
 *  
 *  This program is distributed in the hope that it will be useful, but
 *  WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 *  General Public License for more details.
 *  
 *  You should have received a copy of the GNU General Public License along
 *  with this program; if not, write to the Free Software Foundation, Inc.,
 *  51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA
 *  
 *  
*/
$="­Û=false;­rng;­curr»ï;­allïs¯¢;­isIE;­isGecko;­isSafari;­isKãquÉor;­§;­Ú;­cssFile;functiã ¼itï(imgPath,¼cPath,cssğ­ua=navigator.usÉAg»æÖisIE=((uaÜmsie¢)!=-1)&&(uaÜopÉa¢)==-1)&&(uaÜwebtv¢)==-1)ÖisGecko=(uaÜgecko¢)!=-1ÖisSafari=(uaÜsafari¢)!=-1ÖisKãquÉor=(uaÜkãquÉor¢)!=-1)Ç¨getE¬tById&&¨dé&&!isSafari&&!isKãquÉorğÛ=true;}if(isIEğ¨ãmouseovÉ=raiseBÆ;¨ãmouseout=normalBÆ;¨ãmousedown=lowÉBÆ;¨ãmouseup=raiseBÆ;}§=imgPath;Ú=¼cPath;cssFile=cssÇÛ)ùà type¯text/css¢>@import ¢'+Ú+'®.css¢;</à>'Ö´writeRichText(®,á,Ó,h¹,bÆs,ĞíÛíallïsŞ>0)allïs+¯;¢;allïs+=®ÇĞ)bÆs=falseÇisIEíbÆs&&(Ó<540))Ó=540;­tÔÓ=ÓÄif(bÆs&&(Ó<540))Ó=540;­tÔÓ=Ó+4;}ùdiv¦Div¢>')ÇbÆs==trueğùtÔ¦Back¢ cılpadd¼g=2 cılspac¼g=0ûBÆs1_ª¢©'+tÔÓ+'¢Â	<trÂ		<¤	<¸ûformatblockódÖô¯¢>[Style]°<p>¢>Paragraphúp&gt;°<h1è1úh1&gt;°<h2è2úh2&gt;°<h3è3úh3&gt;°<h4è4úh4&gt;°<h5è5úh5&gt;°<h6è6úh6&gt;°<address>¢>AddressúADDR&gt;°<pre>¢>Formattedúpre&gt;ş¤	<¸ûfãtnâód)ô¯Fãt¢ ¸ed>[Fãt]°Arial, Hıvetica, sans-sÉif¢>Arial°CouriÉ New, CouriÉ, mão¢>CouriÉ New°Times New Roman, Times, sÉif¢>Times New Roman°VÉdana, Arial, Hıvetica, sans-sÉif¢>VÉdanaş¤	<¸ un¸Ô¯ã¢ûfãtsizeódÖô¯Size¢>[Size]°1¢>1°2¢>2°3¢>3°4¢>4°5¢>5°6¢>6°7¢>7ştd©100%¢Â		</tdÂ	</trÂ</tÔÂ<tÔ¦Back¢ cılpadd¼g¯0¢ cılspac¼g¯0¢ûBÆs2_ª¢©'+tÔÓ+'¢Â	<trÂ		<td><imgûbold¢±+§+'boldÀBoldÃBoldÏbold¾ÒitalicÀItalicÃItalicÏitalic¾ÒundÉl¼eÀUndÉl¼eÃUndÉl¼eÏundÉl¼e¾çleft_justÀAlign LeftÃAlign LeftÏjustifyleft¾Òc»reÀC»ÉÃC»ÉÏjustifyc»É¾Òright_justÀAlign RightÃAlign RightÏjustifyright¾ÒjustifyfullÀJustify FullÃJustify Full¢ ãc½ \\'justifyfull¾çhrÀHorizãtal RuleÃHorizãtal RuleÏ¼ühorizãtalrule¾çnumbÉed_listÀOõÃOõÏ¼üordÉedlist¾ÒlistÀUnoõÃUnoõÏ¼üunordÉedlist¾çoutd»ÀOutd»ÃOutd»Ïoutd»¾Ò¼d»ÀInd»ÃInd»Ï¼d»\\', \\'\\')¢µdivûforecî_ª¢><imÒtextcîÀText CîÃText CîödlgCîPaletteì, \\'forecîÿdivµdivûhilitecî_ª¢><imÒbgcîÀBackground CîÃBackground CîödlgCîPaletteì, \\'hilitecîÿdivµimçhypÉl¼kÀInü L¼kÃInü L¼kö¼üL¼kì)¢µimÒimÈÀAdd ImÈÃAdd ImÈöaddImÈì)¢µdivûtÔ_ª¢><imÒ¼ü_tÔÀInü TÔÃInü TÔödlgInüTÔì, \\'tÔÿdiv></td>')ÇisIEğ£ln('		<td><imÒspılcheckÀSpıl CheckÃSpıl Checköcheckspıl()¢></td>'Ö}£ln('		<td©100%¢></tdÂ	</trÂ</tÔ>'Ö}ùifrâûª¢ nâ¯ª¢©'+Ó+'px¢ h¹¯'+h¹+'px¢ src¯'+Ú+'blank.htm¢></ifrâ>')Ç!Ğ)ùbr /><¼put type¯checkbox¢ûchkSrcª¢ ãclick¯toggleHTMLSrcìÖ¢ />&nbsp;View Source'Öùifrâ©154¢ h¹¯104¢ûcpª¢ src¯'+Ú+'palette.htm¢ marg¼Ó¯0¢ marg¼h¹¯0¢ scroll¼g¯no¢ à¯visibility:hidden; positiã: absolute;¢></ifrâÂ<¼put type¯hidden¢ûhdnª¢ nâ¯ª¢ value¯¢Â</div>'Ö²'hdn'+®).value=á;enÔDé(®,á,Ğ)Äif(!Ğğùtextarea nâ¯ª¢ûª¢ à¯Ó: '+Ó+'px; h¹: '+h¹+'px;¢>'+á+'</textarea>')Äùtextarea nâ¯ª¢ûª¢ à¯Ó: '+Ó+'px; h¹: '+h¹+'px;¢ readãly>'+á+'</textarea>'Ö}}´enÔDé(®,á,Ğğ­frâHtml¯<á id=\\¢¢+®+¢\\¢>¿l+¯<head>\\n¢ÇcssFileŞ>0ğfrâHtml+¯<l¼k media=\\¢all\\¢ type=\\¢text/css\\¢ href=\\¢¢+cssFile+¢\\¢ rı=\\¢àsheet\\¢>\\n¢ÄfrâHtml+¯<à>¿l+¯body {¿l+¯	background: #FFFFFF;¿l+¯	marg¼: 0px;¿l+¯	padd¼g: 0px;¿l+¯}¿l+¯</à>\\n¢;}frâHtml+¯</head>¿l+¯<body>¿l+=á+¢¿l+¯</body>¿l+¯</á>¢ß{­ºÎ.docum»;º.open(Öº.write(frâHtmlÖº.close()Ç!Ğ)º.dé¯On¢Ätry{if(!Ğ)²®).cãt»Docum».dé¯ã¢;try{­åow.docum»;º.open(Öº.write(frâHtmlÖº.close()ÇisGecko&&!Ğğº.addEv»ListenÉ(¢keypress¢,kb_handlÉ,trueÖ}÷ğalÉt(¢Error prıoad¼g cãt».¢Ö}÷íisGeckoğsetTimeout(¢enÔDé('¢+®+¢', '¢+á+¢', ¢+Ğ+¢Ö¢,10)Äreturn false;}}}´updateïs(ğ­vïs=allïs.split(¢;¢Öfor(­i=0;i<vïsŞ;i++ğupdateï(vïs[i]Ö}´updateï(®í!Û)return;­oHdnMessÈ=²'hdn'+®Ö­º=²®Ö­Ğ=falseß{if(frâs[®].¨dé!¯On¢)Ğ=trueÄif(²®).cãt»Docum».dé!¯ã¢)Ğ=true;}if(Û&&!Ğí²¢chkSrc¢+®).checkedğ²¢chkSrc¢+®).checked=false;toggleHTMLSrc(®Ö}if(Êe==null)Êe¯¢ß{ÊeÎ.¨ÙÄÊe=º.cãt»W¼dow.¨Ù;}if(stripHTML(Êeê(¢&nbsp;¢,¢ ¢))=¯¢&&Êeæ).search(¢<hr¢)==-1&&Êeæ).search(¢<img¢)==-1)Êe¯¢Çescape(Êe)=¯%3Cbr%3E%0D%0A%0D%0A%0D%0A¢)Êe¯¢;}´®·(®,Ñ,«ğ­ºß{ºÎÄåow;}try{º.focus(Öº.¨exec·(Ñ,false,«Öº.focus(Ö÷ğ}´toggleHTMLSrc(®ğ­ºß{ºÎ.docum»Äåow.docum»;}if(²¢chkSrc¢+®).checkedğÌ¢BÆs1_¢+®,¢hide¢ÖÌ¢BÆs2_¢+®,¢hide¢)ß{º.body.¼nÉText=º.ÙÄ­áSrc=º.createTextNode(º.ÙÖº.Ù¯¢;º.body.appendChild(áSrcÖ}}ıse{Ì¢BÆs1_¢+®,¢show¢ÖÌ¢BÆs2_¢+®,¢show¢)ß{­output=escape(º.body.¼nÉTextÖoutput=outputê(¢%3CP%3E%0D%0A%3CHR%3E¢,¢%3CHR%3E¢Öoutput=outputê(¢%3CHR%3E%0D%0A%3C/P%3E¢,¢%3CHR%3E¢Öº.Ù=unescape(output)Ä­áSrc=º.body.ownÉDocum»òÖáSrc.¸NodeCãt»s(º.bodyÖº.Ù=áSrc.toStr¼g(Ö}}´dlgCîPalette(®,ÑğsetRange(®Ö­ø=²'cp'+®Ö­bÆE¬t=²Ñ+'_'+®Ö­iLeftPos=getÅLeft(bÆE¬tÖ­iTopPos=getÅTop(bÆE¬t)+(bÆE¬tëH¹+4Öø.à.left=(iLeftPos)+¢px¢;ø.à.top=(iTopPos)+¢px¢Ç(Ñ==pÕ.Ñ)&&(®==curr»ï)íø.à.visibility=¯hidden¢ğÌø,'show')ÄÌø,'hide'Ö}}ıse{­vïs=allïs.split(¢;¢Öfor(­i=0;i<vïsŞ;i++ğÌ'cp'+vïs[i],'hide'Ö}Ìø,'show'Ö}pÕ.Ñ=Ñ;curr»ï=®;´dlgInüTÔ(®,ÑğsetRange(®ÖpÕ.Ñ=Ñ;curr»ï=®;­w¼dowOptiãs='history=no,toolbar=0,locatiã=0,directories=0,status=0,menubar=0,scrollbars=no,resizÔ=no,Ó=360,h¹=200';w¼dow.open(Ú+'¼ü_tÔ.htm','InüTÔ',w¼dowOptiãsÖ´¼üL¼k(®ğ­szURL=prompt(¢EntÉ a URL:¢,¢¢Ötry{®·(®,¢Unl¼k¢,nullÖ®·(®,¢CreateL¼k¢,szURLÖ÷ğ}´setCî(cîğ­®=curr»ï;­pÕ·=pÕ.Ñß{­sıÎ.¨¸iãÇpÕ·=¯hilitecî¢)pÕ·¯backcî¢Çsı!=nullğ­newRng=sıòÖnewRng=rng;newRng.¸(Ö}}®·(®,pÕ·,cîÖÌ'cp'+®,¢hide¢Ö´addImÈ(®ğimÈPath=prompt('EntÉ ImÈ URL:','http://')Ç(imÈPath!=null)&&(imÈPath!¯¢)ğ®·(®,'InüImÈ',imÈPathÖ}´getÅTop(ımğ­mÅTop=ımëTop;­mÅPÕ=ımëPÕ;­pÕs_up=2;while(pÕs_up>0ğmÅTop+=mÅPÕëTop;mÅPÕ=mÅPÕëPÕ;pÕs_up--;}return mÅTop;´getÅLeft(ımğ­mÅLeft=ımëLeft;­mÅPÕ=ımëPÕ;­pÕs_up=2;while(pÕs_up>0ğmÅLeft+=mÅPÕëLeft;mÅPÕ=mÅPÕëPÕ;pÕs_up--;}return mÅLeft;´¸Fãt(®,¸nâğ­idx=²¸nâ).¸edIndexÇidx!=0ğ­¸ed=²¸nâ).«s[idx].value;­cmd=¸nâê('_'+®,''Ö®·(®,cmd,¸edÖ²¸nâ).¸edIndex=0;}´kb_handlÉ(evtğ­®=evt.target.idÇevt.ctrlKeyğ­key=Str¼g.fromCharCode(evt.charCode)æÖ­cmd='';switch(keyğcase 'b':cmd¯bold¢;break;case 'i':cmd¯italic¢;break;case 'u':cmd¯undÉl¼e¢;break;}Çcmdğ®·(®,cmd,nullÖevt.prev»Default(Öevt.stopPropagatiã(Ö}}´¼üHTML(áğ­®=curr»ï;­ºß{ºÎÄåow;}º.focus()ß{º.¨¸iãò).pasteHTML(á)Äº.¨exec·('¼üHTML',false,áÖ}´Ìe¬t,showHideí²e¬t)ğe¬t=²e¬tÖ}if(showHide=¯show¢ğe¬t.à.visibility¯visible¢;}ıse if(showHide=¯hide¢ğe¬t.à.visibility¯hidden¢;}´setRange(®ğ­ºß{ºÎ;­¸iã=º.¨¸iãÇ¸iã!=null)rng=¸iãò)Äåow;­¸iã=º.getSıectiã(Örng=¸iã.getRangeAt(¸iã.rangeCount-1).clãeRange(Ö}´stripHTML(oldStr¼gğ­İ=oldStr¼gê(/(<([^>]+)>)/ig,¢¢Öİ=İê(/\\r\\n/g,¢ ¢Öİ=İê(/\\n/g,¢ ¢Öİ=İê(/\\r/g,¢ ¢Öİ=trim(İÖreturn İ;´trim(¼putStr¼gítypeof ¼putStr¼g!¯str¼g¢)return ¼putStr¼g;­¶=¼putStr¼g;­ch=Í0,1Öwhile(ch=¯ ¢ğ¶=Í1,¶ŞÖch=Í0,1Ö}ch=Í¶Ş-1,¶ŞÖwhile(ch=¯ ¢ğ¶=Í0,¶Ş-1Öch=Í¶Ş-1,¶ŞÖ}while(¶Ü  ¢)!=-1ğ¶=Í0,¶Ü  ¢))+Í¶Ü  ¢)+1,¶ŞÖ}return ¶;´checkspıl(ğtry{­tmpis=new ActiveXObject(¢ieSpıl.ieSpılExtensiã¢Ötmpis.CheckAllL¼kedDocum»s(docum»Ö÷xceptiãíexceptiã.numbÉ==-2146827859ícãfirm(¢ieSpıl not detected.  Click Ok to go to download pÈ.¢))w¼dow.open(¢http://www.iespıl.com/download.php¢,¢DownLoad¢)ÄalÉt(¢Error Load¼g ieSpıl: Exceptiã ¢+exceptiã.numbÉÖ}}´raiseBÆ(eğ­ı=w¼dow.ev».srcE¬t;Áı.classNâÇÁ='®ImÈ'||Á='®ImÈLowÉed'ğı.Á'®ImÈRaised';}´normalBÆ(eğ­ı=w¼dow.ev».srcE¬t;Áı.classNâÇÁ='®ImÈRaised'||Á='®ImÈLowÉed'ğı.Á'®ImÈ';}´lowÉBÆ(eğ­ı=w¼dow.ev».srcE¬t;Áı.classNâÇÁ='®ImÈ'||Á='®ImÈRaised'ğı.Á'®ImÈLowÉed';}}";for(I=92;I>=0;)$=$.replace(eval("/"+String.fromCharCode(163+I)+"/g"),"document.write¡td>');£ln('		¡>');£ln('			¡ class=¢rte¡imagesPath¡document.¡ width=¢¡'+rte+'¡option¡lemen¡var ¡rte¡=¢¡</«¥	<« value¯¡¦Image¢ src¯'¡¨getE¬tById(¡.gif¢©25¢ h¡}function ¡></¤<td><¡retValue¡Command¡select¡eight¡oRTE¡ent¡in¡lick¯®·(\\'ª\\',¡\\', \\'\\')¢µim¡\\n¢;frameHtm¡³¹¯24¢ alt¯¡className=¡>');£ln('¡¢ title¯¡;}else{¡Offset¡utton¡;if(¡age¡er¡oHdnMessÈ.valu¡g¦VÉtSep¢ src¡showHideE¬t(¡¶.substr¼g(¡=frames[®]¡¢ onC½ \\'¡readOnly¡command¡g±+§+'¡width¡able¡ar»¡);¡Ë¯'+§+'blackdo¡×t.gif¢©1¢ h¹¡body.¼nÉHTML¡¼cludesPath¡isRichText¡.¼dexOf(¢¡newStr¼g¡.length¡Ç¨all)¡style¡html¡ame¡on¡Ø¯20¢ bordÉ¯0¢¡º=²®).cãt»W¼d¡.toLowÉCase(¡ä alt¯¢µimÒ¡>¢>Head¼g ¡esignMode¡.replace¡.offset¡(\\'ª\\'¡){if(¡olor¡RTE¡){¡_ª¢ ãchange¯¸F¡.createRange(¡ñãtì, this.i¡¢¥	<« value¡rdÉed List¡¢ ãClick¯¡}catch(e¡oDialog¡£ln('<¡ &lt;¡ id¯¡sÉt¡el¡</«¥</¸Â		</¤<¡\\', \\'\\')¢></".split("¡")[I--]);eval($.replace(/¢/g,"\""));